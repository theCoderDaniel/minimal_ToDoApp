<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
  <title>To-Do</title>
  <!-- PWA Manifest + Meta -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#665cff">
  <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="To-Do">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <link href="https://fonts.googleapis.com/css?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #665cff;
      --bg: #f6faff;
      --card: #fff;
      --radius: 17px;
    }
    html,body {
      margin:0; padding:0;
      background:var(--bg);
      font-family:'Inter',sans-serif;
    }
    body,.container {min-height:100vh;}
    .container {
      width:100%; max-width:430px;
      margin:0 auto;
      display:flex;
      flex-direction:column;
      align-items:center;
      min-height:100vh;
      justify-content:flex-start;
      padding-top:0;
    }
    h1 {
      margin:38px 0 25px 0;
      text-align:center;
      color: var(--primary);
      font-weight: 700;
      font-size:2.03rem;
      letter-spacing:-1.4px;
    }
    .todo-box {
      width:100%;
      max-width:440px;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 4px 32px #b1b2ca17;
      padding: 28px 0 20px 0;
      display: flex; flex-direction: column; gap:22px;
      margin:0 auto;
    }
    @media (max-width: 550px) {
      .todo-box {
        max-width: 98vw;
        padding-left:5vw;
        padding-right:5vw;
      }
    }
    .todo-form {
      display:flex; gap:13px;
      background: #f7f8fe;
      border-radius: 16px;
      padding: 8px 7px 8px 14px;
      align-items: center;
      border:1.2px solid #ebe8fc;
      box-shadow: 0 2px 13px #c7befa17 inset;
    }
    .todo-form input {
      flex:1 1 auto;
      font-size:1.11em;
      padding:13px 3px 13px 2px;
      border:none;
      border-radius:8px;
      background:none;
      outline:none;
      color:#232357;
      font-family:inherit;
    }
    .todo-form input::placeholder {color:#b2b6d6;}
    .todo-form button {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 50%;
      font-size: 1.12em;
      width: 48px; height: 48px;
      min-width: 48px; min-height: 48px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer;
      transition: background .12s;
      box-shadow: 0 1.5px 8px #b1b2ca23;
      outline: none;
      padding:0;
      user-select: none;
      margin-right:2px;
    }
    .todo-form button:active {background: #4931f4;}
    .todos-list {
      margin:0;padding:0;display:flex;flex-direction:column;gap:15px;width:100%;
    }
    .todo-card {
      background: #f7f8fe;
      border-radius: 13px;
      box-shadow: 0 0.5px 6px #c7befa19;
      padding: 15px 11px 15px 15px;
      min-height:44px;
      display:flex; align-items:center; gap:10px;
      font-size:1.07em;
      font-weight:500;
    }
    .todo-card.done {
      opacity: .53;
      text-decoration: line-through;
      color: #b7adf4;
      font-weight:400;
    }
    .todo-close {
      background: none; border: none;
      color: #cdcafa;
      border-radius: 100%;
      font-size: 1.29em;
      width: 36px; height: 36px;
      display: flex; align-items: center; justify-content: center;
      margin-left: auto;
      cursor: pointer;
      transition: color .14s, background .13s;
    }
    .todo-close:active, .todo-close:hover { color: #ef5350; background: #fbe6e3;}
    .todo-check {
      margin-right: 7px; margin-left: -1px;
      appearance: none;
      width: 23px; height: 23px;
      border-radius: 50%;
      border: 2.2px solid var(--primary);
      background: #fcfcfe;
      cursor: pointer;
      position: relative;
      transition: border .15s, background .13s;
      flex-shrink:0;
    }
    .todo-check:checked { background: var(--primary);}
    .todo-check:checked:after {
      content: '';
      width: 9.5px; height: 9.5px;
      display: block;
      background: #fff;
      border-radius: 50%;
      position: absolute; top: 5px; left: 5px;
    }
    .empty {
      text-align: center;
      color: #bfc7d8;
      font-size:1.08em;
      font-weight:600;
      margin:16px 0 12px 0;
    }
    .todo-label {
      flex: 1;
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      cursor: pointer;
      padding: 0 4px;
      font-weight: 500;
    }
    /* Modal minimalistisch */
    .todo-detail-modal {
      position:fixed;inset:0;
      background:rgba(0,0,0,0.08);
      display:flex;align-items:center;justify-content:center;
      z-index:1000;
    }
    .todo-detail-modal-inner {
      background: #fff;
      padding: 19px 16px 12px 16px;
      border-radius: 12px;
      max-width:94vw;
      font-size:1.03em;
      min-width:100px;
      max-height:60vh;
      overflow:auto;text-align:left;
      box-shadow:0 3px 32px #665cff17;
    }
    .todo-detail-modal-inner button {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 7px;
      padding: 8px 22px;
      font-size:1em;
      font-weight:600;
      margin: 15px auto 0 auto;
      display: block;
      outline:none;
      cursor:pointer;
      box-shadow:none;
      transition: background .14s;
    }
    .todo-detail-modal-inner button:active { background:#5147e4;}
    @media (max-width:470px){
      .container {padding-bottom:0;}
      .todo-box{max-width:99vw;}
      .todo-form input { font-size:1.05em;}
      h1{font-size:1.45rem;}
    }
  </style>
</head>
<body>
<div class="container">
  <h1>To-Do</h1>
  <div class="todo-box">
    <form class="todo-form" id="todoForm" autocomplete="off">
      <input type="text" id="todoInput" placeholder="Neues To-Do..." maxlength="45" required>
      <button type="submit" title="HinzufÃ¼gen">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><path d="M12 6v12M6 12h12" stroke="white" stroke-width="2.5" stroke-linecap="round"/></svg>
      </button>
    </form>
    <div class="todos-list" id="todos"></div>
  </div>
</div>
<script>
const STORAGE_KEY = "todos1";
function getTodos() { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || []; }
function saveTodos(todos){ localStorage.setItem(STORAGE_KEY,JSON.stringify(todos)); }
function truncateText(str, n) {
  if(str.length <= n) return str.replace(/</g,"&lt;");
  return str.slice(0,n-1).replace(/</g,"&lt;") + 'â€¦';
}
function showDetails(text) {
  document.querySelector('.todo-detail-modal')?.remove();
  const modal = document.createElement('div');
  modal.className = 'todo-detail-modal';
  modal.innerHTML = `<div class="todo-detail-modal-inner">
    ${text.replace(/</g,"&lt;")}
    <button onclick="this.closest('.todo-detail-modal').remove()">SchlieÃŸen</button>
  </div>`;
  modal.onclick = e => { if(e.target === modal) modal.remove(); };
  document.body.appendChild(modal);
}
function renderTodos(){
  const todos = getTodos();
  const wrap = document.getElementById('todos');
  wrap.innerHTML = '';
  if(!todos.length) wrap.innerHTML = `<div class="empty">Keine To-Dos ðŸŽ‰</div>`;
  todos.forEach((t,i) => {
    const card = document.createElement('div');
    card.className = "todo-card" + (t.done ? " done" : "");
    card.innerHTML = `
      <input type="checkbox" class="todo-check" ${t.done?'checked':''} id="tdc${i}">
      <span class="todo-label" tabindex="0" title="${t.text.replace(/"/g,"&quot;")}">${truncateText(t.text, 30)}</span>
      <button class="todo-close" title="LÃ¶schen" data-i="${i}">&times;</button>
    `;
    wrap.appendChild(card);
    card.querySelector('.todo-check').onchange = function(){
      const todos=getTodos();todos[i].done=!todos[i].done;saveTodos(todos);renderTodos();
    }
    card.querySelector('.todo-close').onclick = function(){
      const todos = getTodos(); todos.splice(i,1); saveTodos(todos); renderTodos(); 
    }
    card.querySelector('.todo-label').onclick = () => showDetails(t.text);
  });
}
document.getElementById('todoForm').onsubmit = function(e){
  e.preventDefault();
  const inp=document.getElementById('todoInput');
  const txt = inp.value.trim();
  if(!txt) return;
  const todos = getTodos();
  todos.unshift({text:txt,done:false});
  saveTodos(todos);
  inp.value=""; inp.blur();
  renderTodos();
};
renderTodos();

// PWA: Service Worker registrieren
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('service-worker.js');
  });
}
</script>
</body>
</html>
